---
---
<style>
    .container {
        max-width: 1000px;
        margin: 0 auto;
        background: white;
        padding: 30px;
        border-radius: 8px
    }

    table {
        width: 100%;
        border-collapse: collapse
    }

    th,
    td {
        padding: 12px;
        text-align: left;
        border-bottom: 1px solid #ddd
    }

    code {
        font-family: monospace;
        word-break: break-all
    }
</style>
<script>
    async function decrypt(ciphertext) {
        try {
            const pemContents = prompt("Enter your private key")
                .replace(/-----(BEGIN|END) PRIVATE KEY-----/g, "")
                .replace(/\s/g, "");

            const binaryDer = Uint8Array.fromBase64(pemContents);

            const key = await crypto.subtle.importKey(
                "pkcs8",
                binaryDer,
                { name: "RSA-OAEP", hash: "SHA-1" },
                false,
                ["decrypt"]
            );

            const plaintext = await crypto.subtle.decrypt({ name: "RSA-OAEP" }, key, Uint8Array.fromHex(ciphertext));

            alert(new TextDecoder().decode(plaintext));
        } catch (e) {
            console.error(e);
            alert(`Error: ${e}`);
        }
    }
</script>
<div class="container">
    <h1>ðŸŽ… Secret Santa Assignments</h1>
    <p>Commit: <a
            href="{{ site.data.assignments.metadata.repo_url }}/commit/{{ site.data.assignments.metadata.commit_hash }}"><code>{{ site.data.assignments.metadata.commit_hash }}</code></a>
    </p>
    <p>Run ID: <a
            href="{{ site.data.assignments.metadata.repo_url }}/actions/runs/{{ site.data.assignments.metadata.run_id }}"><code>{{
            site.data.assignments.metadata.run_id }}</code></a></p>
    <p>Generated at: {{ site.data.assignments.metadata.generated_at }}</p>
    <table>
        <tr>
            <th>Gifter</th>
            <th>Recipient</th>
            <th></th>
        </tr>
        {% for item in site.data.assignments.assignments %}
        <tr>
            <td><strong>{{ item[0] }}</strong></td>
            <td><code>{{ item[1] }}</code></td>
            <td><button onclick="decrypt('{{ item[1] }}')">Decrypt</button></td>
        </tr>
        {% endfor %}
    </table>
</div>